\name{SM90}
\alias{ddtSM90}
\alias{propSM90}
\alias{ddtSM90_no}
\alias{propSM90_no}
\alias{mapSM90}
\alias{mapSM90.alt}
 
%- Also NEED an '\alias' for EACH other topic documented here.
\title{Climate state derivative according to the Saltzman and Maasch model}

\usage{
propSM90(...) 
propSM90_no(...) 
ddtSM90(time, state, parms,Rforcing=zero,fmu=zero)
ddtSM90_no(time, state, parms,Rforcing=zero,fmu=zero)
mapSM90(parms)
mapSM90.alt (parms)
}
%- maybe also 'usage' for other objects documented here.
\arguments{
  \item{time}{time, years after 1950}
  \item{state}{Climate state,  a tuple with elements '\code{I}', '\code{mu}' and '\code{theta}'
               corresponding to ice volume (in E18 kg), CO2 concentration (in ppm) and
               deep ocean temperature, respectively}
  \item{parms}{vector with all parameters corresponding
               to the full equations (8 - 10) in original reference. Note that in 
               \code{propSM90} parameters must be supplied in the same order
               as mapSM90. }
  \item{Rforcing}{time-function or scalar representing the Insolation forcing (R in eq. 8)}
  \item{fmu}{time-function or scalar representing the Carbon cycle  forcing (Fmu in eq. 9)}
  \item{...}{parameters to be passed to \code{propagate.stochastic}}
}
\details{
}

\description{
  \code{ddtSM90} returns the time-derivative of the climatic state vector
  \code{propSM90} returns the state vector at time \code{newt}, given its value at time \code{oldt}, 
                  given the SM90 mdoel. Cf. \code{propagate_stochastic} for more information.
 \code{mapSM90} maps the set of standard parameters as given in p. 321 of original reference
                    (\code{p,q,r,lambda_i,c,Ktheta,KR}) to
                    the form (\code{alpha,beta,gamma}) as given in p. 322. A few errors in Saltzman's
                    derivation have been corrected. The standard set of these parameters is given
                    in mapSM90.
 \code{mapSM90.alt} maps the set of standard parameters as given in p. 321 (\code{ai, bi, ci}) to
                    the form (\code{alpha,beta,gamma}) as given in p. 322. A few errors in Saltzman's
                    derivation have been corrected. The standard set of these parameters is given
                    in mapSM90.alt.
 \code{ddtSM90_no}  identical to ddtSM90 but written in \code{R} instead of \code{Fortran}. Much slower.
 \code{propSM90_no}  identical to propSM90 but calling \code{propSM90_no} instead of {propSM90}. 
}


\references{
Saltzman, B. and Maasch, K., A first-order global model of late Cenozoic climatic change, Trans. 
Roy. Soc. Edinb.: Earth Sciences, 81, 315-325, 1990.
}
  
\author{Michel Crucifix, U. catholique de Louvain, Belgium.}

\examples{
# reproduces Figure 5 of the Saltzman and Maash 1990 reference.
# but in dimensional form
t <- seq(-5e5,0,1e3)
Rforcing <- sapply(t, function (tt) Insol(ber78(tt),long=120*pi/180,lat=65*pi/180))
Rforcing <- Rforcing - mean(Rforcing)
Rforcing <- approxfun(t,Rforcing)
par <- mapSM90(parSM90)
SM90.Fig5 <- ts_stochastic (ddtSM90,init=c(I=-20,mu=253,theta=6.5),t,par=par,
                           Rforcing=Rforcing,stochastic=FALSE)
SM90.Fig5 <- cbind(F=Rforcing(t),SM90.Fig5)
SM90.Fig5 <- ts(SM90.Fig5,start=t[1],deltat=t[2]-t[1])
plot(SM90.Fig5)
# reproduces Figure 10 of the Saltzman and Maash 1990 reference.
t <- seq(-3e6,0,2e3)
Rforcing <- sapply(t, function (tt) Insol(ber78(tt),long=120*pi/180,lat=65*pi/180))
Rforcing <- Rforcing - mean(Rforcing)
Rforcing <- approxfun(t,Rforcing)
par <- mapSM90(parSM90)
fmu <- function(t) {(t*1e-6 )^2/25*0.03-0.0010}
SM90.Fig10 <- ts_stochastic (ddtSM90,init=c(I=-20,mu=253,theta=6.5),t,par=par,fmu=fmu,Rforcing=Rforcing,stochastic=FALSE)
SM90.Fig10 <- cbind(Fmu=fmu(t),SM90.Fig10)
SM90.Fig10 <- ts(SM90.Fig10,start=t[1],deltat=t[2]-t[1])
plot(SM90.Fig10)
}
% Add one or more standard keywords, see file 'KEYWORDS' in the
% R documentation directory.
\keyword{misc}

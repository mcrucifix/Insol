\name{SV92}
\alias{ddtSV92}
\alias{propSV92}
\alias{mapSV92}
 
%- Also NEED an '\alias' for EACH other topic documented here.
\title{Climate state derivative according to the Saltzman and Maasch model}

\usage{
propSV92(...)
ddtSV92(time, state, parms,Rforcing=Rforcing,fmu=0)
mapSV92(parms)
}
%- maybe also 'usage' for other objects documented here.
\arguments{
  \item{time}{time, years after 1950}
  \item{state}{Climate state,  a tuple with elements '\code{I}', '\code{D}', '\code{mu}' and '\code{theta}'
               corresponding to ice volume (in E18 kg), bedrock deflection (in m), CO2 concentration (in ppm) and
               deep ocean temperature, respectively}
  \item{parms}{all parameters corresponding
               to the full equations (4 - 6) in original reference}
  \item{Rforcing}{time-function or scalar representing the Insolation forcing (R in eq. 4)}
  \item{fmu}{time-function or scalar representing the Carbon cycle  forcing (Fmu in eq. 5)}
  \item{...}{parameters to be passed to \code{propagate.stochastic}}
}

\description{
  \code{ddtSV92} returns the time-derivative of the climatic state vector
  \code{propSV92} returns the state vector at time \code{newt}, given its value at time \code{oldt}. Cf.  \code{propagate_stochastic} for other parameters.
 \code{mapSV92} maps the set of standard parameters as used in \code{SM91} 
                    (\code{p,q,r,s,lambda_i,c,K_theta,K_R}) to
                    the form (\code{alpha,beta,gamma}) required to integrate the set of
                    equations (11), (12), (2) and (3) [equation numbers refer to the reference below]
}

\details{SV92 includes four differential equations, for ice volume, bedrock deflection, carbon dioxide
and deep-ocean temperature. Equations for carbon dioxide and deep-ocean temperature are identical
to SM91. Therefore, the same parmaters parameters may be used, both in their dimensional 
(\code{\beta_i} and \code{\gamma_i}) and a-dimensional forms with scaling parameters (\code{p,q,r,s,lambda_2,\lambda3,\mu0,\theta_0}). The conversion between
the two sets of parameters is done by \code{mapSV92} as in SM91. 
Equation for ice voloume is as in SM91, but with one additional term, related to ice calving, plus the condition that ice volume is stricly positive. The conversion between dimensional parameters (\code{alpha_i}) and adimensional ones with scaling (\code{u,v,lambda_1,I_0}) is again done by \code{mapSV92} as in SM91. 
SV92 therefore almost reduces to SM91 when the ice calving parameter \code{alpha_4} is set to zero, except for the strictly positive ice volume condition. The SV92 paper introduces a distinction between fixed point and reference state that has been ignored here to facilitate the comparison between the different models.}
\note{The SV92 model was published as a model showing "chaotic intermittency", able to switch from 40-k oscillations and 100-k oscillations. In fact, these transitions are not strictly chaotic, but they may be triggered either by stochastic or orbital forcings. 100-k oscillations dominate when the calving instability is silent, which allows to reproduce the result of SM91. 40-k oscillations dominate when ice calving triggers rapid deglaciation as soon as some significant ice volume is reached. Calving instability is favoured when the glacial states becomes a stable fixed point.
Note that the original reference claims that both glacial and interglacial states are stable but this is not the case with the standard parameters introduced in SM91. Here I choose to play with the carbon cycle forcing to alter the stability of the fixed points (see examples). "Chaotic intermittency", as shown on Fig. 12 of original reference, only appears with a small range of parameters. }
\references{
  B. Saltzman and M. Y. Verbitsky. Asthenospheric ice-load effects in a global dynamical-system model of the Pleistocene climate. Clim. Dyn., 8:1-11, 1992.
}
  
\author{Michel Crucifix, U. catholique de Louvain, Belgium.}

\examples{
# reproduces Figure 10 of SV92
t <- seq(-3e6,0,2e3)

## reproduces Figure 12 of SV92
Rforcing <- sapply(t, function (tt) Insol(ber78(tt),long=120*pi/180,lat=60*pi/180))
Rforcing <- Rforcing - mean(Rforcing)
Rforcing <- approxfun(t,Rforcing)
par <- mapSV92.alt(parSV92.alt)
SV92.Fig12 <- ts_stochastic (ddtSV92,init=c(I=0,D=0,mu=253,theta=0),t,par=par,Rforcing=Rforcing,fmu=0)

## reproduces Fig 14  (Calving instability dominates when the cold state is marginally stable, but not too much)
SV92.Fig14 <- ts_stochastic (ddtSV92,init=c(I=0,D=0,mu=253,theta=0),t,par=par,fmu=-0.005,stochastic=FALSE,Rforcing=0)

## verifies that glacial state is stable
 par["alpha4"]=0.
SV92.Fig14.bis <- ts_stochastic (ddtSV92,init=c(I=0,D=0,mu=253,theta=0),t,par=par,fmu=-0.005,stochastic=FALSE,Rforcing=0)
}
% Add one or more standard keywords, see file 'KEYWORDS' in the
% R documentation directory.
\keyword{misc}

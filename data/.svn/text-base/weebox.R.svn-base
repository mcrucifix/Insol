# minimal box plot showing quantiles                                                                                             

weebox <- function(y, w, at, width = wd, col = 'grey', xpd = NA) 
{
  oo <- order(y)
  y <- y[oo]
  w <- w[oo]
  prob <- c(0.025, 0.25, 0.5, 0.75, 0.975)
  qemp <- approx(cumsum(w) / sum(w), y, xout = prob)$y
  
  wd <- diff(par('usr')[1:2]) / 100 
  
  segments(at, qemp[1], at, qemp[5], lwd = 1, xpd = xpd)
  rect(at - width/2, qemp[2], at + width/2, qemp[4], col = col,
       xpd = xpd)
  segments(at - width/2, qemp[3], at + width/2, qemp[3], xpd = xpd)

  invisible(qemp)  
}

